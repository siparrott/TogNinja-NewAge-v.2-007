ğŸ§ª **FULL-STACK QA PASS â€“ TogNinja CRM Agent**

You have finished scaffolding all 14 sidebar features.  
Now run an automated verification pass and give me a single report that answers:

| Feature | Tool(s) implemented | DB table present | Jest handler test | Assistant chat test | Status |

where *Status* is âœ… pass / âš ï¸ partial / âŒ fail.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¬  TEST PLAN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. **Unit-level tool tests**  
   â€¢ For each tool in `agent/tools` create `tests/<toolName>.test.ts`.  
   â€¢ Insert a dummy `studio_id`, seed any required rows, call the handler, expect a sane object (id, status:"created", etc.).  
   â€¢ Use Supabase service-role key from `.env`.

2. **Assistant integration tests**  
   â€¢ Spin up the local dev server (`npm run dev` in a child process).  
   â€¢ POST synthetic chat prompts to `POST /api/crm/agent/chat` with `{studioId:"test-studio", userId:"tester", message:"<command>"}`.  
   â€¢ For each feature execute at least one realistic prompt, e.g.  
     â€œcreate a voucher product â€˜Gold Giftâ€™ â‚¬200â€  
     â€œsell voucher â€˜Gold Giftâ€™ to Matt Pantlingâ€  
     â€œlist top clientsâ€  
   â€¢ Capture the assistant JSON, assert `"assistant_response.includes('invoice')"` or similar.

3. **Database schema check**  
   â€¢ For every feature confirm table exists via `pg_catalog.pg_tables`.  
   â€¢ Mark column mismatches as âš ï¸ partial.

4. **Coverage summary**  
   â€¢ Output % of sidebar items that passed.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ› ï¸  IMPLEMENTATION NOTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Use Jest + ts-node for tests (`npx jest`).  
â€¢ Place helper utilities in `tests/_utils.ts`.  
â€¢ Use `@supabase/supabase-js` for live DB queries.  
â€¢ Run migrations (`npm run migrate`) before tests.  
â€¢ Use `supertest` to hit the Express/Vite API while dev server running.  
â€¢ Clean up inserted rows in `afterAll`.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“‘  OUTPUT FORMAT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
After tests finish, print exactly:

